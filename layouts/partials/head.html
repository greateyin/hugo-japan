<head>
  <meta charset="utf-8">
  <title>{{ with .Title }}{{ . }}{{ else }}{{ with site.Title }}{{ . }}{{ end }}{{ end }}</title>

  {{/* ========== Mobile Responsive Meta ========== */}}
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">

  {{/* ========== SEO Meta Description ========== */}}
  {{- $description := .Description | default site.Params.description | default "" -}}
  <meta name="description" content="{{ $description }}">
  {{ with site.Params.author }}
  <meta name="author" content="{{ . }}">{{ end }}

  {{/* ========== Theme Meta ========== */}}
  <meta name="theme-name" content="parsa-hugo" />
  {{ hugo.Generator }}

  {{/* ========== Canonical URL ========== */}}
  <link rel="canonical" href="{{ .Permalink }}">

  {{/* ========== Alternate Language Links ========== */}}
  {{ if .IsTranslated }}
  {{ range .Translations }}
  <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}">
  {{ end }}
  <link rel="alternate" hreflang="{{ .Lang }}" href="{{ .Permalink }}">
  {{ end }}
  <link rel="alternate" hreflang="x-default" href="{{ .Permalink }}">

  {{/* ========== Open Graph Meta ========== */}}
  {{- $ogImage := "" -}}
  {{- if .Params.image -}}
  {{- $ogImage = .Params.image | absURL -}}
  {{- else if .Params.og_image -}}
  {{- $ogImage = .Params.og_image | absURL -}}
  {{- else if site.Params.og_image -}}
  {{- $ogImage = site.Params.og_image | absURL -}}
  {{- else if site.Params.default_image -}}
  {{- $ogImage = site.Params.default_image | absURL -}}
  {{- end -}}

  <meta property="og:site_name" content="{{ site.Title }}">
  <meta property="og:title" content="{{ with .Title }}{{ . }}{{ else }}{{ site.Title }}{{ end }}">
  <meta property="og:description" content="{{ $description }}">
  {{- if .IsPage -}}
  <meta property="og:type" content="article">
  {{- else -}}
  <meta property="og:type" content="website">
  {{- end -}}
  <meta property="og:url" content="{{ .Permalink }}">
  {{ with $ogImage }}
  <meta property="og:image" content="{{ . }}">{{ end }}
  <meta property="og:locale" content="{{ .Lang | default " en" }}">

  {{/* ========== Article-specific Open Graph ========== */}}
  {{ if .IsPage }}
  {{ with .Section }}
  <meta property="article:section" content="{{ . }}">{{ end }}
  {{ with .PublishDate }}
  <meta property="article:published_time" content="{{ .Format " 2006-01-02T15:04:05Z07:00" }}">{{ end }}
  {{ with .Lastmod }}
  <meta property="article:modified_time" content="{{ .Format " 2006-01-02T15:04:05Z07:00" }}">{{ end }}
  {{ range .Params.tags }}
  <meta property="article:tag" content="{{ . }}">{{ end }}
  {{ end }}

  {{/* ========== Twitter Card Meta ========== */}}
  <meta name="twitter:card" content="summary_large_image">
  <meta name="twitter:title" content="{{ with .Title }}{{ . }}{{ else }}{{ site.Title }}{{ end }}">
  <meta name="twitter:description" content="{{ $description }}">
  {{ with $ogImage }}
  <meta name="twitter:image" content="{{ . }}">{{ end }}
  {{ with site.Params.twitter_site }}
  <meta name="twitter:site" content="@{{ . }}">{{ end }}
  {{ with site.Params.twitter_creator }}
  <meta name="twitter:creator" content="@{{ . }}">{{ end }}

  {{/* ========== Geo SEO Meta ========== */}}
  {{ with site.Params.geo }}
  {{ with .region }}
  <meta name="geo.region" content="{{ . }}">{{ end }}
  {{ with .placename }}
  <meta name="geo.placename" content="{{ . }}">{{ end }}
  {{ with .position }}
  <meta name="geo.position" content="{{ . }}">
  <meta name="ICBM" content="{{ replace . " ;" ", " }}">
  {{ end }}
  {{ end }}

  {{/* ========== Google Fonts ========== */}}
  {{ with site.Params.google_fonts }}
  <link rel="preconnect" href="https://fonts.googleapis.com">
  <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
  <link href="https://fonts.googleapis.com/css2?{{ . }}&display=swap" rel="stylesheet">
  {{ end }}

  {{/* ========== Plugin CSS ========== */}}
  {{ range site.Params.plugins.css }}
  {{ if .link }}
  <link rel="stylesheet" href="{{ .link | absURL }}">
  {{ end }}
  {{ end }}

  {{/* ========== Main Stylesheet ========== */}}
  {{ $styles := resources.Get "css/style.css" | minify }}
  <link rel="stylesheet" href="{{ $styles.Permalink }}" media="screen">

  {{/* ========== Custom CSS ========== */}}
  {{ with site.Params.custom_css }}
  <link rel="stylesheet" href="{{ . | absURL }}">
  {{ end }}

  {{/* ========== Favicon ========== */}}
  <link rel="shortcut icon" href="{{ `images/favicon.png` | absURL }}" type="image/x-icon">
  <link rel="icon" href="{{ `images/favicon.png` | absURL }}" type="image/x-icon">

  {{/* ========== Analytics & Tracking (GA, FB Pixel, AdSense) ========== */}}
  {{ partial "analytics.html" . }}

  {{/* ========== Mermaid Support ========== */}}
  {{ if or .Params.mermaid site.Params.mermaid }}
  {{ partial "mermaid.html" . }}
  {{ end }}

  {{/* ========== KaTeX Math Support ========== */}}
  {{ if or .Params.math site.Params.math }}
  {{ partial "math.html" . }}
  {{ end }}

</head>